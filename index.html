<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <title>Animedoro Timer</title>

        <link rel="preconnect" href="https://fonts.bunny.net">
        <link href="https://fonts.bunny.net/css?family=fredoka:400,500|gaegu:400" rel="stylesheet" />
        
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="./logic.js"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
        <script>
            tailwind.config = {
              theme: {
                fontFamily: {
                    sans:   ['Fredoka', 'sans-serif'],
                    serif:  ['Gaegu', 'serif']
                },
                extend: {
                  colors: {
                    antiflash:  '#F0F0F0',
                    delftblue:  '#213555',
                    trueblue:   '#4F709C',
                    flax:       '#E5D283',
                  }
                }
              }
            }
          </script>
    </head>
    <body
        x-data="themingFunctionality"
        x-on:keydown.window="
            if ($event.code == 'ArrowRight') {
                isRightArrow();
            } else if ($event.code == 'ArrowLeft') {
                isLeftArrow();
            } else if ($event.code == 'Space') {
                isSpace();
            }
        "
        x-init="init()"
        :style="themes[currentTheme].cursor ? `cursor: url(https://cdn.custom-cursor.com/db/${themes[currentTheme].cursor}), default !important;` : ''"
        :class="themes[currentTheme].background"
        class="bg-antiflash flex flex-col md:flex-row items-center justify-center min-h-screen transition-all duration-300"
    >
        <div class="flex flex-col gap-6 w-full items-center justify-center">
            <img :src="'https://cdn.custom-cursor.com/db/' + themes[currentTheme].image" class="mt-8 md:mt-0 h-20 pl-4"/>
            <h1 :class="themes[currentTheme].outsideText" class="text-4xl md:text-5xl font-bold">Animedoro Timer</h1>
            <div :class="themes[currentTheme].secondary" class="rounded-full aspect-square w-[90%] sm:w-1/2 lg:w-1/3 xl:w-1/4 2xl:w-1/5 p-2 bg-trueblue">
                <div :class="themes[currentTheme].primary" class="rounded-full aspect-square gap-4 md:gap-8 flex flex-col items-center justify-center transition-all duration-300">
                    <div class="flex flex-col items-center justify-center gap-2">
                            <div class="flex justify-center items-center gap-4 w-full">
                                <button
                                    @click="subtractFiveMinutes()"
                                    :class="themes[currentTheme].insideText"
                                    class="flex justify-center items-center mt-2 opacity-80 hover:opacity-100 transition-opacity duration-300"
                                >-5</button>
                                <h2 x-text="formatTime" :class="themes[currentTheme].insideText" class="text-7xl"></h2>
                                <button
                                    @click="addFiveMinutes()"
                                    :class="themes[currentTheme].insideText"
                                    class="flex justify-center items-center mt-2 opacity-80 hover:opacity-100 transition-opacity duration-300"
                                >+5</button>
                            </div>
                        <p x-show="isStudying" :class="themes[currentTheme].insideText" class="text-center text-lg">until next episode</p>
                        <p x-show="!isStudying" :class="themes[currentTheme].insideText" class="text-center text-lg">until next studying session</p>
                    </div>
                    <div class="flex justify-between gap-4">
                        <button
                            x-show="!isRunning"
                            @click="isRunning = !isRunning; startTimer()"
                            :class="`${themes[currentTheme].buttonText} ${themes[currentTheme].buttonBackground}`"
                            class="text-xl px-2 py-2 rounded-full flex justify-between items-center gap-2"
                        >
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-player-play" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M7 4v16l13 -8z"></path></svg>
                        </button>
                        <button
                            x-show="isRunning"
                            @click="isRunning = !isRunning; stopTimer()"
                            :class="`${themes[currentTheme].buttonText} ${themes[currentTheme].buttonBackground}`"
                            class="text-xl px-2 py-2 rounded-full flex justify-between items-center gap-2"
                        >
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-player-stop" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M5 5m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z"></path></svg>
                        </button>
                        <button
                            @click="restartTimer()"
                            :class="`${themes[currentTheme].buttonText} ${themes[currentTheme].buttonBackground}`"
                            class="text-xl px-2 py-2 rounded-full flex justify-between items-center gap-2"
                        >
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-refresh" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4"></path><path d="M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"></path></svg>   
                        </button>
                        <button
                            @click="skipTimer()"
                            :class="`${themes[currentTheme].buttonText} ${themes[currentTheme].buttonBackground}`"
                            class="text-xl px-2 py-2 rounded-full flex justify-between items-center gap-2"
                        >
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-player-skip-forward" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M4 5v14l12 -7z"></path><path d="M20 5l0 14"></path></svg>
                        </button>
                    </div>
                    <div class="flex flex-col justify-center items-center gap-1">
                        <p :class="themes[currentTheme].insideText">Autostart:</p>
                        <label class="flex items-center cursor-pointer gap-3">
                            <span :class="themes[currentTheme].insideText" class="text-sm">Off</span>
                            <div class="relative">
                                <input type="checkbox" x-model="autostart" class="hidden" />
                                <div :class="themes[currentTheme].secondary" class="w-8 h-4 rounded-full"></div>
                                <div :class="`${themes[currentTheme].background} ${autostart ? 'translate-x-4' : ''}`" class="absolute w-5 bg-white h-5 rounded-full -left-0.5 -top-0.5 transition-transform transform duration-300"></div>
                            </div>
                            <span :class="themes[currentTheme].insideText" class="text-sm">On</span>
                        </label>
                    </div>
                </div>
            </div>
            <audio id="startAnimeSound"><source src="./sound/anime_start.wav" type="audio/wav"></audio>
            <audio id="startStudySound"><source src="./sound/study_start.wav" type="audio/wav"></audio>
            <p :class="themes[currentTheme].outsideText" class="text-2xl">It's <span x-text="isStudying ? 'studying' : themes[currentTheme].title"></span> time</p>
            <div :class="themes[currentTheme].outsideText" class="flex gap-8">
                <div class="flex items-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-notebook" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M6 4h11a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-11a1 1 0 0 1 -1 -1v-14a1 1 0 0 1 1 -1m3 0v18"></path><path d="M13 8l2 0"></path><path d="M13 12l2 0"></path></svg>
                    <span x-text="studySessions"></span></div>
                    <div class="flex items-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-device-tv" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M3 7m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z"></path><path d="M16 3l-4 4l-4 -4"></path></svg>
                    <span x-text="animeEpisodes"></span></div>
            </div>
            <button @click="mobileThemeChange()" :class="`${themes[currentTheme].buttonText} ${themes[currentTheme].buttonBackground}`" class="lg:hidden flex gap-1 items-center px-4 py-2 rounded-full">
                Change theme
                <img :src="themes[currentTheme].cursor ? `https://cdn.custom-cursor.com/db/${themes[currentTheme].cursor}` : 'https://cdn.custom-cursor.com/db/12052/32/ghibli-spirited-away-haku-and-haku-as-a-dragon-cursor.png'" class="w-8 h-8"/>
            </button>
            <div :class="themes[currentTheme].outsideText" class="flex gap-8 text-sm">
                <button @click="resetTimer()">Reset</button>
                <button @click="soundOn = !soundOn; console.log(soundOn)" x-text="soundOn ? 'Sound: on' : 'Sound: off'">Sound</button>
            </div>
        </div>
        <div x-show="themes[currentTheme].url[0] || themes[currentTheme].url[1] || themes[currentTheme].url[2] || themes[currentTheme].url[3]"
            :class="themes[currentTheme].outsideText"
            class="static md:absolute opacity-80 hover:opacity-100 transition-opacity duration-300 flex flex-col md:flex-row items-center justify-between gap-2 bottom-2 right-2 mt-6 md:mt-0"
        >
            <p>Watch on: </p>
            <div class="flex items-center justify-center gap-2">
                <template x-for="(platform, index) in platforms">
                    <a :href="platform[0] + themes[currentTheme].url[index]"  target="_blank"><button x-show="themes[currentTheme].url[index]" class="px-3 py-1 text-sm rounded-full" :class="platform[1]" x-text="platform[2]"></button></a>    
                </template>
            </div>
        </div>
        <p class="static mb-4 md:mb-0 md:absolute bottom-2 left-2 mt-12 md:mt-0 opacity-80 hover:opacity-100 transition-opacity duration-300" :class="themes[currentTheme].outsideText">⌨️ built by <a href="https://github.com/teobourloglou" target="_blank" class="font-bold">@teobourloglou</a> + <span class="font-bold"><a href="https://github.com/SamuelKaf" target="_blank">@samkaf</a></span></p>
        <span @click="isLeftArrow()" :class="themes[currentTheme].outsideText" class="absolute hidden lg:block top-1/2 left-2 font-serif cursor-pointer opacity-80 hover:opacity-100 transition-opacity duration-300">(←) Press left arrow<br>key to change theme</span>
        <span @click="isRightArrow()" :class="themes[currentTheme].outsideText" class="absolute hidden lg:block top-1/2 right-2 font-serif cursor-pointer opacity-80 hover:opacity-100 transition-opacity duration-300">Press right arrow (→)<br>key to change theme</span>
    </body>
</html>